{"version":3,"sources":["../../src/queries/getDatabaseIndexes.js"],"names":["connection","any","sql"],"mappings":";;;;;;;AAEA;;eAQe,MAAOA,UAAP,IAAkF;AAC/F,SAAOA,UAAU,CAACC,GAAX,CAAeC,WAAI;;;;;;;;;;;;;;;;;;;;;;;;GAAnB,CAAP;AAyBD,C","sourcesContent":["// @flow\n\nimport {\n  sql\n} from 'slonik';\nimport type {\n  DatabaseConnectionType,\n  IndexType\n} from '../types';\n\nexport default async (connection: DatabaseConnectionType): Promise<$ReadOnlyArray<IndexType>> => {\n  return connection.any(sql`\n    SELECT\n      c1.relname \"tableName\",\n      c2.relname \"indexName\",\n      i1.indisunique \"indexIsUnique\",\n      array_agg(a1.attname)::text[] \"columnNames\"\n    FROM\n      pg_class c1,\n      pg_class c2,\n      pg_index i1,\n      pg_attribute a1\n    WHERE\n      c1.oid = i1.indrelid\n      AND c2.oid = i1.indexrelid\n      AND a1.attrelid = c1.oid\n      AND a1.attnum = ANY(i1.indkey)\n      AND c1.relkind IN ('r', 'm')\n    GROUP BY\n      c1.relname,\n      c2.relname,\n      i1.indisunique\n    ORDER BY\n      c1.relname,\n      c2.relname\n  `);\n};\n"],"file":"getDatabaseIndexes.js"}