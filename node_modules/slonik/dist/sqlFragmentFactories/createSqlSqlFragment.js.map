{"version":3,"sources":["../../src/sqlFragmentFactories/createSqlSqlFragment.js"],"names":["token","greatestParameterPosition","sql","leastMatchedParameterPosition","Infinity","greatestMatchedParameterPosition","replace","match","g1","parameterPosition","parseInt","values","length","UnexpectedStateError"],"mappings":";;;;;;;AAMA;;8BAIgBA,K,EAAwBC,yB,KAAuD;AAC7F,MAAIC,GAAG,GAAG,EAAV;AAEA,MAAIC,6BAA6B,GAAGC,QAApC;AACA,MAAIC,gCAAgC,GAAG,CAAvC;AAEAH,EAAAA,GAAG,IAAIF,KAAK,CAACE,GAAN,CAAUI,OAAV,CAAkB,UAAlB,EAA8B,CAACC,KAAD,EAAQC,EAAR,KAAe;AAClD,UAAMC,iBAAiB,GAAGC,QAAQ,CAACF,EAAD,EAAK,EAAL,CAAlC;;AAEA,QAAIC,iBAAiB,GAAGJ,gCAAxB,EAA0D;AACxDA,MAAAA,gCAAgC,GAAGI,iBAAnC;AACD;;AAED,QAAIA,iBAAiB,GAAGN,6BAAxB,EAAuD;AACrDA,MAAAA,6BAA6B,GAAGM,iBAAhC;AACD;;AAED,WAAO,OAAOA,iBAAiB,GAAGR,yBAA3B,CAAP;AACD,GAZM,CAAP;;AAcA,MAAII,gCAAgC,GAAGL,KAAK,CAACW,MAAN,CAAaC,MAApD,EAA4D;AAC1D,UAAM,IAAIC,4BAAJ,CAAyB,iFAAzB,CAAN;AACD;;AAED,MAAIV,6BAA6B,KAAKC,QAAlC,IAA8CD,6BAA6B,KAAK,CAApF,EAAuF;AACrF,UAAM,IAAIU,4BAAJ,CAAyB,qCAAzB,CAAN;AACD;;AAED,SAAO;AACLX,IAAAA,GADK;AAELS,IAAAA,MAAM,EAAEX,KAAK,CAACW;AAFT,GAAP;AAID,C","sourcesContent":["// @flow\n\nimport type {\n  SqlSqlTokenType,\n  SqlFragmentType\n} from '../types';\nimport {\n  UnexpectedStateError\n} from '../errors';\n\nexport default (token: SqlSqlTokenType, greatestParameterPosition: number): SqlFragmentType => {\n  let sql = '';\n\n  let leastMatchedParameterPosition = Infinity;\n  let greatestMatchedParameterPosition = 0;\n\n  sql += token.sql.replace(/\\$(\\d+)/g, (match, g1) => {\n    const parameterPosition = parseInt(g1, 10);\n\n    if (parameterPosition > greatestMatchedParameterPosition) {\n      greatestMatchedParameterPosition = parameterPosition;\n    }\n\n    if (parameterPosition < leastMatchedParameterPosition) {\n      leastMatchedParameterPosition = parameterPosition;\n    }\n\n    return '$' + (parameterPosition + greatestParameterPosition);\n  });\n\n  if (greatestMatchedParameterPosition > token.values.length) {\n    throw new UnexpectedStateError('The greatest parameter position is greater than the number of parameter values.');\n  }\n\n  if (leastMatchedParameterPosition !== Infinity && leastMatchedParameterPosition !== 1) {\n    throw new UnexpectedStateError('Parameter position must start at 1.');\n  }\n\n  return {\n    sql,\n    values: token.values\n  };\n};\n"],"file":"createSqlSqlFragment.js"}